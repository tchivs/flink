{
  "flinkVersion":"1.17",
  "nodes":[
    {
      "id":696,
      "type":"stream-exec-table-source-scan_1",
      "scanTableSource":{
        "table":{
          "identifier":"`new-env`.`cluster_0`.`orders`",
          "resolvedTable":{
            "schema":{
              "columns":[
                {
                  "name":"productId",
                  "dataType":"BIGINT"
                },
                {
                  "name":"amount",
                  "dataType":"INT"
                },
                {
                  "name":"orderDate",
                  "dataType":{
                    "type":"TIMESTAMP_WITH_LOCAL_TIME_ZONE",
                    "precision":3,
                    "kind":"ROWTIME"
                  }
                }
              ],
              "watermarkSpecs":[
                {
                  "rowtimeAttribute":"orderDate",
                  "expression":{
                    "rexNode":{
                      "kind":"CALL",
                      "syntax":"BINARY",
                      "internalName":"$-$1",
                      "operands":[
                        {
                          "kind":"INPUT_REF",
                          "inputIndex":2,
                          "type":"TIMESTAMP(3) WITH LOCAL TIME ZONE"
                        },
                        {
                          "kind":"LITERAL",
                          "value":"1000",
                          "type":"INTERVAL SECOND(6) NOT NULL"
                        }
                      ],
                      "type":"TIMESTAMP(3) WITH LOCAL TIME ZONE"
                    },
                    "serializableString":"`orderDate` - INTERVAL '1' SECOND"
                  }
                }
              ]
            },
            "partitionKeys":[],
            "options":{
              "value.avro-registry.confluent.url":"https://psrc-5yyz8.us-west-2.aws.devel.cpdev.cloud",
              "scan.bounded.mode":"unbounded",
              "value.avro-registry.confluent.schema-id":"100008",
              "confluent.kafka.replication-factor":"3",
              "changelog.mode":"append",
              "scan.startup.mode":"earliest-offset",
              "kafka.cleanup-policy":"delete",
              "kafka.retention.time":"604800000 ms",
              "confluent.kafka.logical-cluster-id":"lkc-26jq9y",
              "value.avro-registry.confluent.logical-cluster-id":"lsrc-w6g3q5",
              "confluent.kafka.bootstrap-servers":"SASL_SSL://pkc-8w6ry7.us-west-2.aws.devel.cpdev.cloud:9092",
              "confluent.kafka.topic":"orders",
              "confluent.kafka.transactional-id-prefix":"b949dfda-7c39-4ebe-928a-f51c2efa0917_696",
              "connector":"confluent",
              "kafka.max-message-size":"2097164 bytes",
              "value.format":"avro-registry",
              "kafka.retention.size":"0 bytes",
              "confluent.kafka.consumer-group-id":"b949dfda-7c39-4ebe-928a-f51c2efa0917_696",
              "kafka.partitions":"6"
            }
          }
        },
        "abilities":[
          {
            "type":"WatermarkPushDown",
            "watermarkExpr":{
              "kind":"CALL",
              "syntax":"BINARY",
              "internalName":"$-$1",
              "operands":[
                {
                  "kind":"INPUT_REF",
                  "inputIndex":2,
                  "type":"TIMESTAMP(3) WITH LOCAL TIME ZONE"
                },
                {
                  "kind":"LITERAL",
                  "value":"1000",
                  "type":"INTERVAL SECOND(6) NOT NULL"
                }
              ],
              "type":"TIMESTAMP(3) WITH LOCAL TIME ZONE"
            },
            "idleTimeoutMillis":-1,
            "producedType":{
              "type":"ROW",
              "nullable":false,
              "fields":[
                {
                  "name":"productId",
                  "fieldType":"BIGINT"
                },
                {
                  "name":"amount",
                  "fieldType":"INT"
                },
                {
                  "name":"orderDate",
                  "fieldType":{
                    "type":"TIMESTAMP_WITH_LOCAL_TIME_ZONE",
                    "precision":3,
                    "kind":"ROWTIME"
                  }
                }
              ]
            }
          }
        ]
      },
      "outputType":{
        "type":"ROW",
        "fields":[
          {
            "name":"productId",
            "fieldType":"BIGINT"
          },
          {
            "name":"amount",
            "fieldType":"INT"
          },
          {
            "name":"orderDate",
            "fieldType":{
              "type":"TIMESTAMP_WITH_LOCAL_TIME_ZONE",
              "precision":3,
              "kind":"ROWTIME"
            }
          }
        ]
      },
      "description":"TableSourceScan(table=[[new-env, cluster_0, orders, watermark=[-(orderDate, 1000:INTERVAL SECOND)]]], fields=[productId, amount, orderDate])",
      "inputProperties":[]
    },
    {
      "id":697,
      "type":"stream-exec-local-window-aggregate_1",
      "configuration":{
        "table.local-time-zone":"default"
      },
      "grouping":[
        0
      ],
      "aggCalls":[
        {
          "name":"EXPR$1",
          "internalName":"$SUM$1",
          "argList":[
            1
          ],
          "filterArg":-1,
          "distinct":false,
          "approximate":false,
          "ignoreNulls":false,
          "type":"INT"
        }
      ],
      "windowing":{
        "strategy":"TimeAttribute",
        "window":{
          "type":"TumblingWindow",
          "size":"PT24H"
        },
        "timeAttributeType":{
          "type":"TIMESTAMP_WITH_LOCAL_TIME_ZONE",
          "precision":3,
          "kind":"ROWTIME"
        },
        "timeAttributeIndex":2,
        "isRowtime":true
      },
      "inputProperties":[
        {
          "requiredDistribution":{
            "type":"UNKNOWN"
          },
          "damBehavior":"PIPELINED",
          "priority":0
        }
      ],
      "outputType":"ROW<`productId` BIGINT, `sum$0` INT, `$slice_end` BIGINT>",
      "description":"LocalWindowAggregate(groupBy=[productId], window=[TUMBLE(time_col=[orderDate], size=[86400000 ms])], select=[productId, SUM(amount) AS sum$0, slice_end('w$) AS $slice_end])"
    },
    {
      "id":698,
      "type":"stream-exec-exchange_1",
      "inputProperties":[
        {
          "requiredDistribution":{
            "type":"HASH",
            "keys":[
              0
            ]
          },
          "damBehavior":"PIPELINED",
          "priority":0
        }
      ],
      "outputType":"ROW<`productId` BIGINT, `sum$0` INT, `$slice_end` BIGINT>",
      "description":"Exchange(distribution=[hash[productId]])"
    },
    {
      "id":699,
      "type":"stream-exec-global-window-aggregate_1",
      "configuration":{
        "table.local-time-zone":"default"
      },
      "grouping":[
        0
      ],
      "aggCalls":[
        {
          "name":"EXPR$1",
          "internalName":"$SUM$1",
          "argList":[
            1
          ],
          "filterArg":-1,
          "distinct":false,
          "approximate":false,
          "ignoreNulls":false,
          "type":"INT"
        }
      ],
      "windowing":{
        "strategy":"SliceAttached",
        "window":{
          "type":"TumblingWindow",
          "size":"PT24H"
        },
        "timeAttributeType":{
          "type":"TIMESTAMP_WITH_LOCAL_TIME_ZONE",
          "precision":3,
          "kind":"ROWTIME"
        },
        "sliceEnd":2,
        "isRowtime":true
      },
      "namedWindowProperties":[
        {
          "name":"window_start",
          "property":{
            "kind":"WindowStart",
            "reference":{
              "name":"w$",
              "type":{
                "type":"TIMESTAMP_WITH_LOCAL_TIME_ZONE",
                "precision":3,
                "kind":"ROWTIME"
              }
            }
          }
        },
        {
          "name":"window_end",
          "property":{
            "kind":"WindowEnd",
            "reference":{
              "name":"w$",
              "type":{
                "type":"TIMESTAMP_WITH_LOCAL_TIME_ZONE",
                "precision":3,
                "kind":"ROWTIME"
              }
            }
          }
        }
      ],
      "inputProperties":[
        {
          "requiredDistribution":{
            "type":"UNKNOWN"
          },
          "damBehavior":"PIPELINED",
          "priority":0
        }
      ],
      "localAggInputRowType":{
        "type":"ROW",
        "fields":[
          {
            "name":"productId",
            "fieldType":"BIGINT"
          },
          {
            "name":"amount",
            "fieldType":"INT"
          },
          {
            "name":"orderDate",
            "fieldType":{
              "type":"TIMESTAMP_WITH_LOCAL_TIME_ZONE",
              "precision":3,
              "kind":"ROWTIME"
            }
          }
        ]
      },
      "outputType":"ROW<`productId` BIGINT, `EXPR$1` INT, `window_start` TIMESTAMP(3) NOT NULL, `window_end` TIMESTAMP(3) NOT NULL>",
      "description":"GlobalWindowAggregate(groupBy=[productId], window=[TUMBLE(slice_end=[$slice_end], size=[86400000 ms])], select=[productId, SUM(sum$0) AS EXPR$1, start('w$) AS window_start, end('w$) AS window_end])"
    },
    {
      "id":700,
      "type":"stream-exec-calc_1",
      "projection":[
        {
          "kind":"INPUT_REF",
          "inputIndex":0,
          "type":"BIGINT"
        },
        {
          "kind":"INPUT_REF",
          "inputIndex":1,
          "type":"INT"
        },
        {
          "kind":"CALL",
          "syntax":"SPECIAL",
          "internalName":"$CAST$1",
          "operands":[
            {
              "kind":"INPUT_REF",
              "inputIndex":2,
              "type":"TIMESTAMP(3) NOT NULL"
            }
          ],
          "type":"DATE NOT NULL"
        }
      ],
      "condition":null,
      "inputProperties":[
        {
          "requiredDistribution":{
            "type":"UNKNOWN"
          },
          "damBehavior":"PIPELINED",
          "priority":0
        }
      ],
      "outputType":"ROW<`productId` BIGINT, `EXPR$1` INT, `EXPR$2` DATE NOT NULL>",
      "description":"Calc(select=[productId, EXPR$1, CAST(window_start AS DATE) AS EXPR$2])"
    },
    {
      "id":701,
      "type":"stream-exec-sink_1",
      "configuration":{
        "table.exec.sink.keyed-shuffle":"AUTO",
        "table.exec.sink.not-null-enforcer":"ERROR",
        "table.exec.sink.rowtime-inserter":"DISABLED",
        "table.exec.sink.type-length-enforcer":"IGNORE",
        "table.exec.sink.upsert-materialize":"AUTO"
      },
      "dynamicTableSink":{
        "table":{
          "identifier":"`new-env`.`cluster_0`.`orders_day_summary`",
          "resolvedTable":{
            "schema":{
              "columns":[
                {
                  "name":"productId",
                  "dataType":"BIGINT"
                },
                {
                  "name":"amount",
                  "dataType":"INT"
                },
                {
                  "name":"summaryDate",
                  "dataType":"DATE"
                }
              ],
              "watermarkSpecs":[]
            },
            "partitionKeys":[],
            "options":{
              "value.avro-registry.confluent.url":"https://psrc-5yyz8.us-west-2.aws.devel.cpdev.cloud",
              "scan.bounded.mode":"unbounded",
              "value.avro-registry.confluent.schema-id":"100009",
              "confluent.kafka.replication-factor":"3",
              "changelog.mode":"retract",
              "scan.startup.mode":"earliest-offset",
              "kafka.cleanup-policy":"delete",
              "kafka.retention.time":"604800000 ms",
              "confluent.kafka.logical-cluster-id":"lkc-26jq9y",
              "value.avro-registry.confluent.logical-cluster-id":"lsrc-w6g3q5",
              "confluent.kafka.bootstrap-servers":"SASL_SSL://pkc-8w6ry7.us-west-2.aws.devel.cpdev.cloud:9092",
              "confluent.kafka.topic":"orders_day_summary",
              "confluent.kafka.transactional-id-prefix":"b949dfda-7c39-4ebe-928a-f51c2efa0917_701",
              "connector":"confluent",
              "kafka.max-message-size":"2097164 bytes",
              "value.format":"avro-registry",
              "kafka.retention.size":"0 bytes",
              "confluent.kafka.consumer-group-id":"b949dfda-7c39-4ebe-928a-f51c2efa0917_701",
              "kafka.partitions":"6"
            }
          }
        }
      },
      "inputChangelogMode":[
        "INSERT"
      ],
      "inputProperties":[
        {
          "requiredDistribution":{
            "type":"UNKNOWN"
          },
          "damBehavior":"PIPELINED",
          "priority":0
        }
      ],
      "outputType":"ROW<`productId` BIGINT, `EXPR$1` INT, `EXPR$2` DATE NOT NULL>",
      "description":"Sink(table=[new-env.cluster_0.orders_day_summary], fields=[productId, EXPR$1, EXPR$2])"
    },
    {
      "id":702,
      "type":"stream-exec-sink_1",
      "configuration":{
        "table.exec.sink.keyed-shuffle":"AUTO",
        "table.exec.sink.not-null-enforcer":"ERROR",
        "table.exec.sink.rowtime-inserter":"DISABLED",
        "table.exec.sink.type-length-enforcer":"IGNORE",
        "table.exec.sink.upsert-materialize":"AUTO"
      },
      "dynamicTableSink":{
        "table":{
          "resolvedTable":{
            "schema":{
              "columns":[
                {
                  "name":"productId",
                  "dataType":"BIGINT"
                },
                {
                  "name":"EXPR$1",
                  "dataType":"INT"
                },
                {
                  "name":"EXPR$2",
                  "dataType":"DATE NOT NULL"
                }
              ],
              "watermarkSpecs":[]
            },
            "partitionKeys":[],
            "options":{
              "connector":"cc-foreground-sink"
            }
          }
        }
      },
      "inputChangelogMode":[
        "INSERT"
      ],
      "inputProperties":[
        {
          "requiredDistribution":{
            "type":"UNKNOWN"
          },
          "damBehavior":"PIPELINED",
          "priority":0
        }
      ],
      "outputType":"ROW<`productId` BIGINT, `EXPR$1` INT, `EXPR$2` DATE NOT NULL>",
      "description":"Sink(table=[*anonymous_cc-foreground-sink$195*], fields=[productId, EXPR$1, EXPR$2])"
    }
  ],
  "edges":[
    {
      "source":696,
      "target":697,
      "shuffle":{
        "type":"FORWARD"
      },
      "shuffleMode":"PIPELINED"
    },
    {
      "source":697,
      "target":698,
      "shuffle":{
        "type":"FORWARD"
      },
      "shuffleMode":"PIPELINED"
    },
    {
      "source":698,
      "target":699,
      "shuffle":{
        "type":"FORWARD"
      },
      "shuffleMode":"PIPELINED"
    },
    {
      "source":699,
      "target":700,
      "shuffle":{
        "type":"FORWARD"
      },
      "shuffleMode":"PIPELINED"
    },
    {
      "source":700,
      "target":701,
      "shuffle":{
        "type":"FORWARD"
      },
      "shuffleMode":"PIPELINED"
    },
    {
      "source":700,
      "target":702,
      "shuffle":{
        "type":"FORWARD"
      },
      "shuffleMode":"PIPELINED"
    }
  ]
}
